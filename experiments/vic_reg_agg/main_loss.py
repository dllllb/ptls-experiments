# -*- coding: utf-8 -*-
"""main_loss.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1m1m985Kfds1oZPgLt_QJGbzhraOfh5X7
"""

class Loss(nn.Module):
    def __init__(self, contrastiveLoss, vicregLoss):
        super(Loss, self).__init__()

        self.contrastiveLoss = contrastiveLoss
        self.vicregLoss = vicregLoss

    def forward(self, embeddings, target, aggs):

        losses = self.vicregLoss(embeddings, aggs)
        cov_loss = losses[0]
        std_loss = losses[1]
        con_loss = self.contrastiveLoss.forward(embeddings, target)

        return [[con_loss, cov_loss, std_loss], 0.55 * con_loss + cov_loss + std_loss]